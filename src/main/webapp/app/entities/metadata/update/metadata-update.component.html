<div id="page-heading" class="row">
  <div class="col-10">
    <span>MetaData</span>
    <span> >> MetaData Creation</span>
  </div>

  <div class="col-2 d-flex justify-content-end">
    <button
      type="button"
      id="save-entity"
      data-cy="entityCreateSaveButton"
      [disabled]="editForm.invalid || isSaving"
      class="btn btn-primary btn-sm"
      (click)="save()"
    >
      <fa-icon icon="save"></fa-icon>
      <span class="d-none d-md-inline" jhiTranslate="entity.action.save">Save</span>
    </button>
    <span style="width: 5px"></span>
    <button type="button" id="cancel-save" class="btn btn-secondary btn-sm" (click)="cancel()">
      <fa-icon icon="ban"></fa-icon>
      <span class="d-none d-md-inline" jhiTranslate="entity.action.new">New</span>
    </button>
  </div>
</div>

<div id="page-heading" class="row">
  <form name="editForm" role="form" novalidate (ngSubmit)="save()" [formGroup]="editForm">
    <jhi-alert-error></jhi-alert-error>

    <jhi-alert></jhi-alert>

    <div class="form-group" [hidden]="editForm.get('id')!.value == null">
      <div class="form-group col-6">
        <label class="form-control-label" jhiTranslate="global.field.id" for="field_id">ID</label>
        <input type="number" class="form-control" name="id" id="field_id" data-cy="id" formControlName="id" [readonly]="true" />
      </div>
    </div>

    <div class="form-group">
      <div class="form-group col-6">
        <label class="form-control-label" jhiTranslate="dmsApp.metaData.docTitle" for="field_docTitle">Document Title</label>
        <input type="text" class="form-control" name="docTitle" id="field_docTitle" data-cy="docTitle" formControlName="docTitle" />
      </div>
    </div>

    <div class="form-group">
      <div class="form-group col-12">
        <label class="form-control-label" jhiTranslate="dmsApp.metaData.detailsField" for="field_docTitle">Please Add Detail Fields</label>
        <div class="tbl-container">
          <table class="table" formArrayName="fieldList">
            <thead>
              <tr>
                <th class="text-center" style="width: 25%">Field Name</th>
                <th class="text-center" style="width: 10%">Field Type</th>
                <th class="text-center" style="width: 25%">Field Value</th>
                <th class="text-center" style="width: 10%">Field Mandatory</th>
                <th class="text-center" style="width: 15%">Field Order</th>
                <th class="text-center" style="width: 10%">Add/ Remove</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of fieldList().controls; last as isLast; let i = index" [formGroupName]="i">
                <td>
                  <input type="text" class="col-12 form-control" placeholder="Field Name" formControlName="fieldName" />
                </td>
                <td>
                  <select class="form-control" name="fieldType" formControlName="fieldType" (change)="onFieldTypeChange(i)">
                    <option [value]="data.value" *ngFor="let data of fieldTyepList">{{ data.caption }}</option>
                  </select>
                </td>

                <td>
                  <input
                    *ngIf="fieldList().controls[i].get('fieldType')?.value !== 'LOV'"
                    type="text"
                    class="col-12 form-control"
                    placeholder="Field Value"
                    formControlName="fieldValue"
                  />

                  <div
                    *ngIf="fieldList().controls[i].get('fieldType')?.value === 'LOV'"
                    class="input-group col-12"
                    style="padding: 0px !important"
                  >
                    <input
                      type="text"
                      readonly
                      placeholder="Field Value"
                      formControlName="fieldValue"
                      class="form-control input-sm"
                      style="background: white"
                      (click)="addLovValue(i)"
                    />
                    <div class="input-group-append">
                      <span class="input-sm input-btn-primary" (click)="addLovValue(i)">
                        <fa-icon icon="plus"></fa-icon>
                      </span>
                    </div>
                  </div>
                </td>

                <td>
                  <select class="form-control" name="isRequired" formControlName="isRequired">
                    <option [value]="data.value" *ngFor="let data of mendatoryList">{{ data.caption }}</option>
                  </select>
                </td>

                <td>
                  <input type="number" class="col-12 form-control" readonly placeholder="Field Order" formControlName="fieldOrder" />
                </td>

                <td>
                  <span title="Remove" (click)="removeField(i)">
                    <fa-icon icon="minus" class="fa-icon-theme text-danger"></fa-icon>
                  </span>
                  <span *ngIf="isLast" title="Add" (click)="addField()">
                    <fa-icon icon="plus" class="fa-icon-theme text-success"></fa-icon>
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </form>
</div>
